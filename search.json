[{"title":"Linux系统编译FFmpeg","url":"//how-to-build-ffmpeg.html","content":"\n> 强烈推荐使用系统源安装ffmpeg，例如： `sudo apt install ffmpeg` for Ubuntu。\n> 当不能满足需求的时候再手动编译吧。\n\n有些Linux发行版可以在线安装ffmpeg，但是因为版权关系不能包含我们所需的编码器，有时候还是需要手动编译。\n下面介绍一些常见编码器的安装。**libx264**、**libx265**、**libfdk-aac**、**libmp3lame**、**libvpx**、**libopus**、**libaom for AV1**。不需要的可以不安装，最终ffmpeg configure不指定特定的编码器就可以了。\n\n<!--more-->\n对版本没要求的，可以使用发行版对应的应用仓库的命令进行安装。\n不想自己编译的可以直接下载我编译好的，GNU C Library (GNU libc) 版本大于等于2.17的系统都可以使用。常见的CentOS 7和Ubuntu13.04以上都应该都可以。 \n[https://github.com/lmshao/FFmpegBinary/releases](https://github.com/lmshao/FFmpegBinary/releases)\n\n\n# 编译第三方库\n## nasm\nnasm是汇编编译器，有些编码器包含汇编代码，需要使用nasm。有些系统命令安装的nasm版本比较低，比如centos7 yum版本2.10。可以选择手动编译安装2.15版本。\n```sh\nwget https://www.nasm.us/pub/nasm/releasebuilds/2.15.05/nasm-2.15.05.tar.xz\ntar Jxvf nasm-2.15.05.tar.xz\npushd nasm-2.15.05\n\n./configure\nmake && make install\n\npopd\n```\n\n## libx264\nlibx264是市面上评价比较高的H.264编码器，很多高清电影都是使用x264压缩的。\n```sh\nwget https://code.videolan.org/videolan/x264/-/archive/master/x264-master.tar.bz2\ntar jxvf x264-master.tar.bz2\npushd x264-master\n\n./configure --enable-shared\nmake && make install\n\npopd\n```\n\nUbuntu系统在线安装\n```\nsudo apt install libx264-dev\n```\n\n## libx265\nhg类似于git，好多系统可以在线安装这个命令。`apt install mercurial` / `yum install mercurial`。\n默认8bit编码模式，可以在配置时把 HIGH_BIT_DEPTH=ON 选择10bit。\n```sh\nhg clone http://hg.videolan.org/x265\npushd x265/build/linux/\ncmake ../../source -DHIGH_BIT_DEPTH=ON\nmake && make install\n\npopd\n```\n\nUbuntu系统在线安装\n```\nsudo apt install libx265-dev\n```\n\n## libfdk-aac\nlibfdk-aac是目前评价最高的开源aac编码器。Ubuntu仓库没有这个，必须手动编译安装。\n```sh\nwget -O fdk-aac-2.0.1.tar.gz https://sourceforge.net/projects/opencore-amr/files/fdk-aac/fdk-aac-2.0.1.tar.gz/download\ntar zxvf fdk-aac-2.0.1.tar.gz\npushd fdk-aac-2.0.1\n\n./configure\nmake && make install\n\npopd\n```\n\n## libmp3lame\nlibmp3lame 是mp3编码器。\n```sh\nwget -O lame-3.100.tar.gz https://sourceforge.net/projects/lame/files/lame/3.100/lame-3.100.tar.gz/download\ntar zxvf lame-3.100.tar.gz\npushd lame-3.100\n\n./configure\nmake && make install\n\npopd\n```\n\nUbuntu系统在线安装\n```\napt install libmp3lame-dev\n```\n\n## libvpx\nlibvpx 是开源视频编码格式 VP8/VP9 的编码器。\n```sh\nwget https://github.com/webmproject/libvpx/archive/v1.10.0/libvpx-1.10.0.tar.gz\ntar zxvf libvpx-1.10.0.tar.gz \npushd libvpx-1.10.0\n\nmkdir libvpx-build && cd libvpx-build\n../configure --enable-shared --disable-static\nmake && make install\n\npopd\n```\n\nUbuntu系统在线安装\n```\napt install libopus-dev\n```\n\n## libopus\nlibopus 是编码opus格式用的。\n```sh\nwget https://archive.mozilla.org/pub/opus/opus-1.3.1.tar.gz\ntar zxvf opus-1.3.1.tar.gz\npushd opus-1.3.1\n\n./configure --enable-shared --disable-static\nmake && make install\n\npopd\n```\n\nUbuntu系统在线安装\n```\napt install libopus-dev\n```\n\n## libaom\n新出的 AV1 视频编码器\n```sh\ngit clone https://aomedia.googlesource.com/aom\ngit checkout v3.2.0 -b v3.2.0 #可指定版本\nmkdir build && pushd build\ncmake .. -DBUILD_SHARED_LIBS=1\nmake && make install\n```\n\n## Intel  Media SDK - Intel 硬件加速 qsv\n\n下载` Intel-Media-SDK`，[https://github.com/Intel-Media-SDK/MediaSDK/releases\n](https://github.com/Intel-Media-SDK/MediaSDK/releases\n)，运行`install_media.sh` 默认安装在`/opt/`目录下了。\n\n```\nexport PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/opt/intel/mediasdk/lib64/pkgconfig\n```\nffmepg 配置参数\n```\n--enable-libmfx\n```\n\n# 编译FFmpeg\n需要的编码器按照上述的文档安装完后，在配置ffmpeg的时候使用特定的参数指定就可以集成进去了。\n```sh\nwget https://www.ffmpeg.org/releases/ffmpeg-4.4.tar.bz2\ntar jxvf ffmpeg-4.4.tar.bz2\npushd ffmpeg-4.4\n\nexport PKG_CONFIG_PATH=/usr/local/lib/pkgconfig/:$PKG_CONFIG_PATH\n./configure --enable-shared --disable-static --enable-gpl --enable-nonfree \\\n\t--enable-libx264 \\\n\t--enable-libx265 \\\n\t--enable-libfdk-aac \\\n\t--enable-libmp3lame \\\n\t--enable-libvpx \\\n\t--enable-libopus \\\n\t--enable-libaom\n\nmake && make install\n\npopd\n```\nmake install 后 ffmpeg 命令和相应的动态库就安装到系统目录了，默认一般是`/usr/local/bin/`和 `/usr/local/lib/`目录，可以使用`./configure --prefix=./xxxxx`来指定安装目录。\n\n## 编译 ffplay\n默认编译可能没有编译出来ffplay，可以通过以下方法编译ffplay。\n\n安装SDL2\n```sh\nsudo apt install libsdl2-dev  # Ubuntu\n```\nconfigure 参数\n```\n--enable-ffplay\n```\n\n---\n不想动手的，可以下载这个[FFmpeg 4.4.1 Binary](https://github.com/lmshao/FFmpegBinary/releases/tag/v2012.13.03)。","tags":["ffmpeg"],"categories":["技术","音视频"]},{"title":"Hello World","url":"//hello-world.html","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n<!--more-->\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n"}]